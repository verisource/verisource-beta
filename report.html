<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VeriSource ‚Äì Verification Report</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .pill { border-radius: 999px; }
    @keyframes glowPulse {
      0% { box-shadow: 0 0 0 0 rgba(56, 189, 248, 0.6); }
      50% { box-shadow: 0 0 0 9px rgba(56, 189, 248, 0); }
      100% { box-shadow: 0 0 0 0 rgba(56, 189, 248, 0); }
    }
    .badge-glow { animation: glowPulse 1.8s ease-in-out infinite; }
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="bg-slate-950 text-slate-100 min-h-screen">

  <!-- HEADER -->
  <header class="border-b border-slate-800 bg-slate-950/80 backdrop-blur sticky top-0 z-40">
    <div class="max-w-7xl mx-auto px-4 lg:px-8 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="h-10 w-10 rounded-2xl bg-gradient-to-br from-blue-400 to-cyan-400 flex items-center justify-center text-slate-950 font-extrabold text-xl shadow">V</div>
        <div>
          <h1 class="text-xl font-semibold tracking-tight">VeriSource</h1>
          <p class="text-[11px] text-slate-400">Comprehensive Media Verification Report</p>
        </div>
      </div>
      <div class="hidden sm:flex items-center gap-3 text-xs">
        <button onclick="exportCSV()" class="px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition">Export CSV</button>
        <button onclick="window.print()" class="px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg transition">Print Report</button>
        <a href="single-upload.html" class="px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg transition">‚Üê Back to Upload</a>
      </div>
    </div>
  </header>

  <!-- No Data Message -->
  <div id="noDataMessage" class="hidden max-w-7xl mx-auto px-4 lg:px-8 py-20 text-center fade-in">
    <div class="text-6xl mb-4">üìã</div>
    <h2 class="text-2xl font-bold mb-2">No Verification Data</h2>
    <p class="text-slate-400 mb-6">Please upload a file first to see the verification report.</p>
    <a href="single-upload.html" class="px-6 py-3 bg-blue-600 hover:bg-blue-500 rounded-lg transition inline-block">
      Upload File
    </a>
  </div>

  <!-- Main Report Content -->
  <main id="reportContent" class="max-w-7xl mx-auto px-4 lg:px-8 py-10 space-y-8">

    <!-- 1. FILE NAME + CONFIDENCE + BLOCKCHAIN BADGE -->
    <section class="flex flex-col sm:flex-row sm:items-center justify-between fade-in">
      <h2 id="fileName" class="text-2xl font-semibold">Loading...</h2>
      <div class="flex items-center gap-4 mt-4 sm:mt-0">
        <div class="flex items-center gap-3">
          <p id="overallConfidence" class="text-4xl font-bold text-blue-400 leading-none">
            0<span class="text-xl align-top">%</span>
          </p>
          <p class="text-[11px] uppercase tracking-[0.18em] text-slate-400">
            Overall<br/>Confidence
          </p>
        </div>
        <!-- Blockchain Badge (shown when anchored) -->
        <div id="blockchainBadge" class="hidden flex items-center gap-2 px-3 py-1.5 pill bg-sky-500/10 border border-sky-500/40 text-sky-300 text-[11px] font-medium shadow badge-glow">
          <div class="h-4 w-4 rounded-full bg-sky-400 flex items-center justify-center">
            <div class="h-2 w-2 bg-slate-900 rounded-full"></div>
          </div>
          <span id="blockchainChainName">Blockchain Verified</span>
        </div>
      </div>
    </section>

    <!-- 2. VERDICT BADGE -->
    <section class="flex flex-col sm:flex-row justify-between items-center gap-3 fade-in">
      <div id="verdictBadge" class="inline-flex items-center gap-2 px-4 py-2 pill border text-sm font-medium">
        <!-- Populated by JS -->
      </div>
      <div id="confidenceLevel" class="text-xs text-slate-400">
        <!-- Populated by JS: "HIGH CONFIDENCE" etc -->
      </div>
    </section>

    <!-- 3. WARNINGS (if any) -->
    <section id="warningsSection" class="hidden bg-amber-500/10 border border-amber-500/30 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-amber-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-amber-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold text-amber-300">Warnings</h2>
          <p class="text-[11px] text-amber-200/70">Issues detected during verification</p>
        </div>
      </header>
      <ul id="warningsList" class="space-y-2 text-amber-200">
        <!-- Populated by JS -->
      </ul>
    </section>

    <!-- 4. QUICK STATS + CRYPTOGRAPHIC FINGERPRINT -->
    <section class="grid grid-cols-1 lg:grid-cols-3 gap-6 fade-in">
      <!-- Quick Stats -->
      <aside class="bg-slate-900/60 border border-slate-800 rounded-2xl p-6">
        <h3 class="text-sm font-semibold mb-4">Quick Stats</h3>
        <div class="space-y-3 text-xs">
          <div class="flex justify-between">
            <span class="text-slate-400">File Type</span>
            <span id="fileType">-</span>
          </div>
          <div class="flex justify-between">
            <span class="text-slate-400">File Size</span>
            <span id="fileSize">-</span>
          </div>
          <div class="flex justify-between">
            <span class="text-slate-400">Media Kind</span>
            <span id="mediaKind">-</span>
          </div>
          <div class="flex justify-between">
            <span class="text-slate-400">Times Verified</span>
            <span id="timesVerified">1</span>
          </div>
          <div class="flex justify-between">
            <span class="text-slate-400">First Seen</span>
            <span id="firstSeen">-</span>
          </div>
        </div>
      </aside>

      <!-- Cryptographic Fingerprint -->
      <section class="lg:col-span-2 bg-slate-900/60 border border-slate-800 rounded-2xl p-6 relative overflow-hidden">
        <header class="flex items-center justify-between mb-4">
          <div>
            <h2 class="text-sm font-semibold">Cryptographic Fingerprint</h2>
            <p class="text-[11px] text-slate-400">Content identity & hash verification</p>
          </div>
          <button onclick="copyHash()" class="px-3 py-1 bg-slate-800 hover:bg-slate-700 rounded text-[10px] transition">
            Copy Hash
          </button>
        </header>

        <!-- Decorative fingerprint icon -->
        <div class="absolute top-4 right-4 opacity-10 h-28 w-28 pointer-events-none">
          <svg class="w-full h-full text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"
              d="M12 11c0 3.6-1.2 7.5-3.6 11.2M9 6.75c0-2.7 3-2.7 3 0 0 5.3-1.2 10.3-3.6 15.3M15 6.75c0-2.7-3-2.7-3 0M18 7.5c0 5.7-1.2 11.3-3.6 17" />
          </svg>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-xs">
          <div>
            <p class="text-slate-400 mb-1">SHA-256 Hash</p>
            <p id="sha256Hash" class="font-mono bg-slate-950/70 p-2 rounded-xl break-all text-[10px]">
              -
            </p>
          </div>
          <div>
            <p class="text-slate-400 mb-1">Perceptual Hash (pHash)</p>
            <p id="pHash" class="font-mono bg-slate-950/70 p-2 rounded-xl break-all text-[10px]">
              -
            </p>
          </div>
        </div>
      </section>
    </section>
    <section id="blockchainSection" class="hidden bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-sky-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-sky-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold">Blockchain Verification</h2>
          <p class="text-[11px] text-slate-400">Immutable timestamp proof on Bitcoin & Polygon</p>
        </div>
      </header>
      
      <!-- OpenTimestamps (Bitcoin) -->
      <div id="opentimestampsCard" class="hidden bg-slate-950/50 p-4 rounded-xl mb-4">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2">
            <span class="text-xl">‚Çø</span>
            <div>
              <h4 class="font-semibold text-slate-300">Bitcoin Blockchain</h4>
              <p class="text-[10px] text-slate-400">Via OpenTimestamps</p>
            </div>
          </div>
          <span id="otsStatus" class="px-2 py-1 pill text-[10px] font-semibold">
            <!-- Status badge -->
          </span>
        </div>
        
        <div class="space-y-2">
          <div class="flex justify-between">
            <span class="text-slate-400">Status</span>
            <span id="otsStatusText" class="font-semibold">-</span>
          </div>
          <div class="flex justify-between">
            <span class="text-slate-400">Submitted</span>
            <span id="otsSubmitted">-</span>
          </div>
          <div id="otsBlockRow" class="hidden flex justify-between">
            <span class="text-slate-400">Bitcoin Block</span>
            <span id="otsBlock" class="font-mono">-</span>
          </div>
          <div id="otsTimestampRow" class="hidden flex justify-between">
            <span class="text-slate-400">Confirmed</span>
            <span id="otsTimestamp">-</span>
          </div>
        </div>
        
        <div id="otsProof" class="mt-3 pt-3 border-t border-slate-800">
          <a id="otsVerifyLink" href="#" target="_blank" class="text-sky-400 hover:text-sky-300 text-[10px] flex items-center gap-1">
            <span>Verify independently ‚Üí</span>
          </a>
        </div>
      </div>

      <!-- Polygon -->
      <div id="polygonCard" class="hidden bg-slate-950/50 p-4 rounded-xl">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-purple-400" viewBox="0 0 38.4 33.5" fill="currentColor">
              <path d="M29,10.2c-0.7-0.4-1.6-0.4-2.4,0L21,13.5l-3.8,2.1l-5.5,3.3c-0.7,0.4-1.6,0.4-2.4,0L5,16.3c-0.7-0.4-1.2-1.2-1.2-2.1v-5c0-0.8,0.4-1.6,1.2-2.1l4.3-2.5c0.7-0.4,1.6-0.4,2.4,0L16,7.2c0.7,0.4,1.2,1.2,1.2,2.1v3.3l3.8-2.2V7c0-0.8-0.4-1.6-1.2-2.1l-8-4.7c-0.7-0.4-1.6-0.4-2.4,0L1.2,5C0.4,5.4,0,6.2,0,7v9.4c0,0.8,0.4,1.6,1.2,2.1l8.1,4.7c0.7,0.4,1.6,0.4,2.4,0l5.5-3.2l3.8-2.2l5.5-3.2c0.7-0.4,1.6-0.4,2.4,0l4.3,2.5c0.7,0.4,1.2,1.2,1.2,2.1v5c0,0.8-0.4,1.6-1.2,2.1L29,28.8c-0.7,0.4-1.6,0.4-2.4,0l-4.3-2.5c-0.7-0.4-1.2-1.2-1.2-2.1V21l-3.8,2.2v3.3c0,0.8,0.4,1.6,1.2,2.1l8.1,4.7c0.7,0.4,1.6,0.4,2.4,0l8.1-4.7c0.7-0.4,1.2-1.2,1.2-2.1V17c0-0.8-0.4-1.6-1.2-2.1L29,10.2z"/>
            </svg>
            <div>
              <h4 class="font-semibold text-slate-300">Polygon Network</h4>
              <p class="text-[10px] text-slate-400">Instant verification</p>
            </div>
          </div>
          <span class="px-2 py-1 pill text-[10px] font-semibold bg-emerald-500/10 border border-emerald-500/40 text-emerald-300">
            ‚úì CONFIRMED
          </span>
        </div>
        
        <div class="space-y-2">
          <div class="flex justify-between">
            <span class="text-slate-400">Transaction</span>
            <a id="polygonTxLink" href="#" target="_blank" class="font-mono text-[10px] text-sky-400 hover:text-sky-300">-</a>
          </div>
          <div class="flex justify-between">
            <span class="text-slate-400">Block Number</span>
            <span id="polygonBlock" class="font-mono">-</span>
          </div>
          <div class="flex justify-between">
            <span class="text-slate-400">Confirmed</span>
            <span id="polygonTimestamp">-</span>
          </div>
          <div class="flex justify-between">
            <span class="text-slate-400">Gas Cost</span>
            <span id="polygonGasCost">-</span>
          </div>
        </div>
        
        <div class="mt-3 pt-3 border-t border-slate-800">
          <a id="polygonExplorer" href="#" target="_blank" class="text-sky-400 hover:text-sky-300 text-[10px] flex items-center gap-1">
            <span>View on PolygonScan ‚Üí</span>
          </a>
        </div>
      </div>

      <!-- No blockchain verification -->
      <div id="noBlockchainCard" class="bg-slate-950/50 p-4 rounded-xl text-center text-slate-400">
        <p class="text-xs">No blockchain verification performed for this file</p>
      </div>
    </section>

    <!-- 5. AI GENERATOR DETECTION + AI CONTENT ANALYSIS -->
    <section id="aiAnalysisSection" class="hidden grid grid-cols-1 xl:grid-cols-3 gap-6 fade-in">
      <!-- AI Generator Detection (2/3 width) -->
      <article class="xl:col-span-2 bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs">
        <header class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-3">
            <div class="h-8 w-8 rounded-xl bg-purple-500/15 flex items-center justify-center">
              <svg class="w-4 h-4 text-purple-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17 9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2z"/>
              </svg>
            </div>
            <div>
              <h3 class="text-sm font-semibold">AI Generator Detection</h3>
              <p class="text-[11px] text-slate-400">Identifies which AI tool likely created this content</p>
            </div>
          </div>
          <div class="text-right">
            <p class="text-[11px] text-slate-400">Likely generator</p>
            <p id="likelyGenerator" class="text-xs font-semibold text-purple-300">Unknown (0%)</p>
          </div>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <div class="flex items-center justify-between mb-1">
              <span class="text-slate-400">Generator confidence</span>
              <span id="generatorConfidence" class="font-semibold">0%</span>
            </div>
            <div class="w-full h-2 rounded-full bg-slate-800 overflow-hidden mb-3">
              <div id="generatorConfidenceBar" class="h-full bg-gradient-to-r from-purple-400 via-fuchsia-400 to-rose-400 transition-all duration-1000" style="width:0%"></div>
            </div>
            <p id="generatorVerdict" class="text-slate-300 mb-2">
              Analyzing generator patterns...
            </p>
            <ul id="generatorIndicators" class="space-y-1 text-slate-400">
              <!-- Populated by JS -->
            </ul>
          </div>

          <div class="space-y-2">
            <p class="text-slate-400 mb-1">Generator probability mix</p>
            <div id="generatorProbabilities" class="space-y-2">
              <!-- Populated by JS -->
            </div>
          </div>
        </div>
      </article>

      <!-- AI Content Analysis (1/3 width) -->
      <article class="bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs flex flex-col justify-between">
        <header class="flex items-center justify-between mb-3">
          <div>
            <h3 class="text-sm font-semibold">AI Content Analysis</h3>
            <p id="ensembleInfo" class="text-[11px] text-slate-400">Ensemble detection</p>
          </div>
          <span id="aiVerdictBadge" class="px-2.5 py-1 pill text-[10px] font-semibold border">
            ANALYZING
          </span>
        </header>

        <div class="space-y-3">
          <div class="flex items-center justify-between">
            <span class="text-slate-400">AI Confidence</span>
            <span id="aiConfidence" class="text-xl font-semibold">0%</span>
          </div>
          <div class="w-full h-2 rounded-full bg-slate-800 overflow-hidden">
            <div id="aiConfidenceBar" class="h-full bg-gradient-to-r from-red-400 via-orange-400 to-amber-400 transition-all duration-1000" style="width:0%"></div>
          </div>

          <div id="detectorScores" class="grid grid-cols-3 gap-2 mt-3">
            <!-- Populated by JS -->
          </div>

          <ul id="aiIndicators" class="mt-3 space-y-1 text-slate-400">
            <!-- Populated by JS -->
          </ul>
        </div>
      </article>
    </section>
<!-- 5B. JPEG FORENSICS ANALYSIS -->
    <section id="jpegForensicsSection" class="hidden bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-cyan-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-cyan-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold">JPEG Forensic Analysis</h2>
          <p class="text-[11px] text-slate-400">Error Level Analysis, compression artifacts, noise patterns</p>
        </div>
      </header>
      
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
        <div class="bg-slate-950/50 p-4 rounded-xl text-center">
          <p id="manipulationConfidence" class="text-2xl font-bold text-cyan-300">0%</p>
          <p class="text-[10px] text-slate-400 mt-1">Manipulation Score</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl text-center">
          <p id="compressionQuality" class="text-2xl font-bold">-</p>
          <p class="text-[10px] text-slate-400 mt-1">Compression Quality</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl text-center">
          <p id="noiseLevel" class="text-sm font-bold capitalize">-</p>
          <p class="text-[10px] text-slate-400 mt-1">Noise Level</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl text-center">
          <p id="elaStatus" class="text-sm font-bold">-</p>
          <p class="text-[10px] text-slate-400 mt-1">ELA Status</p>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <h4 class="font-semibold mb-3 text-slate-300">Compression Analysis</h4>
          <div class="space-y-2">
            <div class="flex justify-between">
              <span class="text-slate-400">Double Compressed</span>
              <span id="doubleCompressed" class="text-emerald-300">No</span>
            </div>
            <div class="flex justify-between">
              <span class="text-slate-400">Quality Estimate</span>
              <span id="qualityEstimate">-</span>
            </div>
          </div>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <h4 class="font-semibold mb-3 text-slate-300">Forensic Indicators</h4>
          <ul id="forensicIndicators" class="space-y-1 text-slate-400">
            <li>‚Ä¢ No forensic analysis performed</li>
          </ul>
        </div>
      </div>
    </section>
    <!-- 6. VIDEO FRAME ANALYSIS (if video) -->
    <section id="videoAnalysisSection" class="hidden bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-blue-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-blue-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold">Video Frame Analysis</h2>
          <p class="text-[11px] text-slate-400">Frame-by-frame AI detection & temporal consistency</p>
        </div>
      </header>
      
      <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-4">
        <div class="bg-slate-950/50 p-4 rounded-xl text-center">
          <p id="framesAnalyzed" class="text-2xl font-bold text-blue-300">0</p>
          <p class="text-[10px] text-slate-400 mt-1">Frames Analyzed</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl text-center">
          <p id="aiFrames" class="text-2xl font-bold text-red-300">0</p>
          <p class="text-[10px] text-slate-400 mt-1">AI Frames</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl text-center">
          <p id="suspiciousFrames" class="text-2xl font-bold text-amber-300">0%</p>
          <p class="text-[10px] text-slate-400 mt-1">Suspicious</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl text-center">
          <p id="aiPercentage" class="text-2xl font-bold text-red-300">0%</p>
          <p class="text-[10px] text-slate-400 mt-1">AI Content</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl text-center">
          <p id="videoVerdict" class="text-sm font-bold text-emerald-300">-</p>
          <p class="text-[10px] text-slate-400 mt-1">Verdict</p>
        </div>
      </div>

      <!-- Temporal Analysis -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <h4 class="font-semibold mb-3 text-slate-300">Temporal Consistency</h4>
          <div class="space-y-2">
            <div class="flex justify-between">
              <span class="text-slate-400">Inconsistencies Detected</span>
              <span id="temporalInconsistencies" class="text-emerald-300">None</span>
            </div>
            <div class="flex justify-between">
              <span class="text-slate-400">Severity</span>
              <span id="temporalSeverity" class="capitalize">Low</span>
            </div>
            <div class="flex justify-between">
              <span class="text-slate-400">Morphing Detected</span>
              <span id="morphingDetected" class="text-emerald-300">No</span>
            </div>
          </div>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <h4 class="font-semibold mb-3 text-slate-300">Video Metadata</h4>
          <div class="space-y-2">
            <div class="flex justify-between">
              <span class="text-slate-400">Duration</span>
              <span id="videoDuration">-</span>
            </div>
            <div class="flex justify-between">
              <span class="text-slate-400">Resolution</span>
              <span id="videoResolution">-</span>
            </div>
            <div class="flex justify-between">
              <span class="text-slate-400">Frame Rate</span>
              <span id="videoFps">-</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 7. AUDIO ANALYSIS (if audio) -->
    <section id="audioAnalysisSection" class="hidden bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-green-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-green-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold">Audio Analysis</h2>
          <p class="text-[11px] text-slate-400">Audio fingerprint & music identification</p>
        </div>
      </header>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Duration</p>
          <p id="audioDuration" class="font-semibold">-</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Chromaprint</p>
          <p id="chromaprint" class="font-mono text-[10px] break-all">-</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Music Identified</p>
          <p id="musicIdentified" class="font-semibold">-</p>
        </div>
      </div>
    </section>

    <!-- 8. DEEPFAKE DETECTION -->
    <section id="deepfakeSection" class="hidden bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-rose-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-rose-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold">Deepfake Detection</h2>
          <p class="text-[11px] text-slate-400">Face manipulation & synthetic media analysis</p>
        </div>
      </header>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Deepfake Detected</p>
          <p id="deepfakeDetected" class="font-semibold text-emerald-300">No</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Confidence</p>
          <p id="deepfakeConfidence" class="font-semibold">0%</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Faces Detected</p>
          <p id="facesDetected" class="font-semibold">0</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Analysis Method</p>
          <p id="deepfakeMethod" class="font-semibold">-</p>
        </div>
      </div>
    </section>

    <!-- 9. CONFIDENCE SCORE BREAKDOWN -->
    <section class="bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-indigo-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-indigo-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold">Confidence Score Breakdown</h2>
          <p class="text-[11px] text-slate-400">Detailed factor analysis contributing to overall score</p>
        </div>
      </header>

      <div id="confidenceFactors" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Populated by JS -->
      </div>
    </section>

    <!-- 10. DUPLICATE/SIMILAR DETECTION -->
    <section id="duplicateSection" class="hidden bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-orange-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-orange-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold">Duplicate & Similar Detection</h2>
          <p class="text-[11px] text-slate-400">Previous verifications & perceptually similar content</p>
        </div>
      </header>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Exact Matches</p>
          <p id="exactMatches" class="font-semibold">0</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Similar Images Found</p>
          <p id="similarImagesCount" class="font-semibold">0</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Total Verifications</p>
          <p id="totalVerifications" class="font-semibold">1</p>
        </div>
      </div>

      <div id="previousVerifications" class="hidden bg-slate-950/50 p-4 rounded-xl">
        <h4 class="font-semibold mb-3 text-slate-300">Previous Verifications</h4>
        <div id="verificationHistory" class="space-y-2 max-h-40 overflow-y-auto">
          <!-- Populated by JS -->
        </div>
      </div>
    </section>

    <!-- 11. FORENSIC ANALYSIS -->
    <section class="bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-green-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-green-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold">Forensic Analysis</h2>
          <p class="text-[11px] text-slate-400">Shadow physics, camera verification & integrity checks</p>
        </div>
      </header>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Shadow Consistency</p>
          <p id="shadowConsistency" class="font-semibold">-</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Camera Make</p>
          <p id="cameraMake" class="font-semibold">-</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Camera Model</p>
          <p id="cameraModel" class="font-semibold">-</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Camera Verified</p>
          <p id="cameraVerified" class="font-semibold">-</p>
        </div>
      </div>
    </section>

    <!-- 12. EXTERNAL VERIFICATION -->
    <section class="bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-cyan-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-cyan-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold">External Verification</h2>
          <p class="text-[11px] text-slate-400">Google Vision, C2PA, VirusTotal, weather & landmark checks</p>
        </div>
      </header>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Google Vision</p>
          <p id="googleVisionStatus" class="font-semibold">-</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">C2PA Credentials</p>
          <p id="c2paStatus" class="font-semibold">-</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">VirusTotal</p>
          <p id="virusTotalStatus" class="font-semibold">-</p>
        </div>
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <p class="text-slate-400 mb-1">Weather/Landmark</p>
          <p id="weatherLandmarkStatus" class="font-semibold">-</p>
        </div>
      </div>
    </section>

  <!-- 12B. REVERSE IMAGE SEARCH DETAILS -->
    <section id="reverseSearchSection" class="hidden bg-slate-900/60 border border-slate-800 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center justify-between mb-4">
        <div class="flex items-center gap-2">
          <div class="h-8 w-8 rounded-xl bg-indigo-500/15 flex items-center justify-center">
            <svg class="w-4 h-4 text-indigo-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </div>
          <div>
            <h2 class="text-sm font-semibold">Reverse Image Search Analysis</h2>
            <p class="text-[11px] text-slate-400">Cross-referenced across TinEye, Bing & Google</p>
          </div>
        </div>
        <button onclick="exportReverseSearchReport()" class="px-3 py-1.5 bg-indigo-500/20 hover:bg-indigo-500/30 border border-indigo-500/40 rounded-lg text-[10px] text-indigo-300 transition flex items-center gap-1">
          <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          Export Report
        </button>
      </header>

      <!-- Warnings Banner -->
      <div id="reverseSearchWarnings" class="hidden mb-4 bg-amber-500/10 border border-amber-500/30 rounded-xl p-3">
        <div class="flex items-start gap-2">
          <svg class="w-4 h-4 text-amber-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
          </svg>
          <div id="reverseSearchWarningsList" class="text-[11px] text-amber-200 space-y-1"></div>
        </div>
      </div>

      <!-- Match Summary Cards -->
      <div class="grid grid-cols-2 md:grid-cols-5 gap-3 mb-4">
        <div class="bg-slate-950/50 p-3 rounded-xl text-center">
          <p id="totalMatchCount" class="text-2xl font-bold text-indigo-300">0</p>
          <p class="text-[10px] text-slate-400 mt-1">Total Matches</p>
        </div>
        <div class="bg-slate-950/50 p-3 rounded-xl text-center">
          <p id="firstSeenDate" class="text-sm font-bold text-slate-200">-</p>
          <p class="text-[10px] text-slate-400 mt-1">First Seen</p>
        </div>
        <div class="bg-slate-950/50 p-3 rounded-xl text-center">
          <p id="imageAgeDisplay" class="text-sm font-bold text-slate-200">-</p>
          <p class="text-[10px] text-slate-400 mt-1">Image Age</p>
        </div>
        <div class="bg-slate-950/50 p-3 rounded-xl text-center">
          <p id="contentTypeDisplay" class="text-sm font-bold text-slate-200">-</p>
          <p class="text-[10px] text-slate-400 mt-1">Content Type</p>
        </div>
        <div class="bg-slate-950/50 p-3 rounded-xl text-center">
          <p id="originalConfidence" class="text-2xl font-bold text-emerald-300">-</p>
          <p class="text-[10px] text-slate-400 mt-1">Originality</p>
        </div>
      </div>

      <!-- Source Category Breakdown -->
      <div class="bg-slate-950/50 p-4 rounded-xl mb-4">
        <h4 class="font-semibold mb-3 text-slate-300 flex items-center gap-2">
          <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
          </svg>
          Source Category Breakdown
        </h4>
        <div id="sourceCategoryBreakdown" class="space-y-2">
          <!-- Stock Photo Sites -->
          <div class="flex items-center gap-3">
            <span class="w-24 text-[10px] text-slate-400">Stock Photos</span>
            <div class="flex-1 bg-slate-800 rounded-full h-2 overflow-hidden">
              <div id="stockPhotoBar" class="h-full bg-red-400 transition-all duration-500" style="width: 0%"></div>
            </div>
            <span id="stockPhotoCount" class="w-8 text-right text-[10px] text-slate-300">0</span>
          </div>
          <!-- News Sites -->
          <div class="flex items-center gap-3">
            <span class="w-24 text-[10px] text-slate-400">News Sites</span>
            <div class="flex-1 bg-slate-800 rounded-full h-2 overflow-hidden">
              <div id="newsBar" class="h-full bg-blue-400 transition-all duration-500" style="width: 0%"></div>
            </div>
            <span id="newsCount" class="w-8 text-right text-[10px] text-slate-300">0</span>
          </div>
          <!-- Social Media -->
          <div class="flex items-center gap-3">
            <span class="w-24 text-[10px] text-slate-400">Social Media</span>
            <div class="flex-1 bg-slate-800 rounded-full h-2 overflow-hidden">
              <div id="socialBar" class="h-full bg-purple-400 transition-all duration-500" style="width: 0%"></div>
            </div>
            <span id="socialCount" class="w-8 text-right text-[10px] text-slate-300">0</span>
          </div>
          <!-- E-commerce -->
          <div class="flex items-center gap-3">
            <span class="w-24 text-[10px] text-slate-400">E-commerce</span>
            <div class="flex-1 bg-slate-800 rounded-full h-2 overflow-hidden">
              <div id="ecommerceBar" class="h-full bg-amber-400 transition-all duration-500" style="width: 0%"></div>
            </div>
            <span id="ecommerceCount" class="w-8 text-right text-[10px] text-slate-300">0</span>
          </div>
          <!-- Blogs -->
          <div class="flex items-center gap-3">
            <span class="w-24 text-[10px] text-slate-400">Blogs</span>
            <div class="flex-1 bg-slate-800 rounded-full h-2 overflow-hidden">
              <div id="blogsBar" class="h-full bg-green-400 transition-all duration-500" style="width: 0%"></div>
            </div>
            <span id="blogsCount" class="w-8 text-right text-[10px] text-slate-300">0</span>
          </div>
          <!-- Other -->
          <div class="flex items-center gap-3">
            <span class="w-24 text-[10px] text-slate-400">Other</span>
            <div class="flex-1 bg-slate-800 rounded-full h-2 overflow-hidden">
              <div id="otherBar" class="h-full bg-slate-400 transition-all duration-500" style="width: 0%"></div>
            </div>
            <span id="otherCount" class="w-8 text-right text-[10px] text-slate-300">0</span>
          </div>
        </div>
      </div>

      <!-- Two Column Layout: Timeline + Found URLs -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        
        <!-- Timeline of Appearances -->
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <h4 class="font-semibold mb-3 text-slate-300 flex items-center gap-2">
            <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            Timeline
          </h4>
          <div id="imageTimeline" class="space-y-2 max-h-48 overflow-y-auto">
            <p class="text-slate-500 text-[10px]">No timeline data available</p>
          </div>
        </div>

        <!-- Found URLs List -->
        <div class="bg-slate-950/50 p-4 rounded-xl">
          <h4 class="font-semibold mb-3 text-slate-300 flex items-center gap-2">
            <svg class="w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
            </svg>
            Found On These Sites
            <span id="urlListCount" class="ml-auto text-[10px] text-slate-500">(0 sites)</span>
          </h4>
          <div id="foundUrlsList" class="space-y-2 max-h-48 overflow-y-auto">
            <p class="text-slate-500 text-[10px]">No URLs found</p>
          </div>
        </div>
      </div>

      <!-- First Appearance Detail -->
      <div id="firstAppearanceDetail" class="hidden mt-4 bg-indigo-500/10 border border-indigo-500/30 rounded-xl p-4">
        <h4 class="font-semibold mb-2 text-indigo-300 flex items-center gap-2">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
          First Known Appearance
        </h4>
        <div class="grid grid-cols-2 gap-4 text-[11px]">
          <div>
            <p class="text-slate-400">Date</p>
            <p id="firstAppearanceDate" class="text-slate-200 font-medium">-</p>
          </div>
          <div>
            <p class="text-slate-400">Source</p>
            <p id="firstAppearanceSource" class="text-slate-200 font-medium">-</p>
          </div>
          <div class="col-span-2">
            <p class="text-slate-400">URL</p>
            <a id="firstAppearanceUrl" href="#" target="_blank" class="text-indigo-300 hover:text-indigo-200 break-all">-</a>
          </div>
        </div>
      </div>
    </section>  
    <section id="recommendationsSection" class="hidden bg-blue-500/10 border border-blue-500/30 rounded-2xl p-6 text-xs fade-in">
      <header class="flex items-center gap-2 mb-4">
        <div class="h-8 w-8 rounded-xl bg-blue-500/15 flex items-center justify-center">
          <svg class="w-4 h-4 text-blue-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
          </svg>
        </div>
        <div>
          <h2 class="text-sm font-semibold text-blue-300">Recommendations</h2>
          <p class="text-[11px] text-blue-200/70">Suggested next steps based on analysis</p>
        </div>
      </header>
      <ul id="recommendationsList" class="space-y-2 text-blue-200">
        <!-- Populated by JS -->
      </ul>
    </section>

    <!-- 15. REPORT TIMESTAMP -->
    <section class="bg-slate-900/30 rounded-2xl p-4 text-center text-xs text-slate-500 fade-in">
      <p id="reportTimestamp">Report generated on -</p>
    </section>

  </main>

   <script>
    // Format file size
    function formatFileSize(bytes) {
      if (!bytes) return '-';
      if (bytes < 1024) return bytes + ' B';
      if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB';
      return (bytes / 1048576).toFixed(2) + ' MB';
    }

    // Format date
    function formatDate(dateString) {
      if (!dateString) return '-';
      const date = new Date(dateString);
      return date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
    }

    // Copy hash to clipboard
    function copyHash() {
      const hash = document.getElementById('sha256Hash').textContent;
      navigator.clipboard.writeText(hash).then(() => {
        alert('Hash copied to clipboard!');
      });
    }

    // Export CSV

    function exportReverseSearchReport() {
      const data = window.currentVerificationResult;
      if (!data || !data.reverse_image_search) {
        alert("No reverse search data available");
        return;
      }
      
      const rs = data.reverse_image_search;
      const combined = rs.combined_analysis || {};
      const bing = rs.bing || {};
      const domains = combined.spread_analysis?.domain_types || bing.domain_breakdown || {};
      const pages = bing.pages_with_image || [];
      
      let report = "VERISOURCE REVERSE IMAGE SEARCH REPORT\n";
      report += "==================================================\n\n";
      report += "Generated: " + new Date().toISOString() + "\n";
      report += "File: " + (data.filename || "Unknown") + "\n";
      report += "SHA-256: " + (data.fingerprint?.hash || "N/A") + "\n\n";
      
      report += "SUMMARY\n";
      report += "------------------------------\n";
      report += "Total Matches: " + (combined.total_matches_found || 0) + "\n";
      report += "First Seen: " + (combined.age_analysis?.first_seen || "Unknown") + "\n";
      report += "Image Age: " + (combined.age_analysis?.age_readable || "Unknown") + "\n";
      report += "Content Type: " + (combined.content_type || "Unknown") + "\n\n";
      
      report += "SOURCE BREAKDOWN\n";
      report += "------------------------------\n";
      report += "Stock Photos: " + (domains.stock_photo_sites || 0) + "\n";
      report += "News Sites: " + (domains.news_sites || 0) + "\n";
      report += "Social Media: " + (domains.social_media || 0) + "\n";
      report += "E-commerce: " + (domains.ecommerce || 0) + "\n";
      report += "Blogs: " + (domains.blogs || 0) + "\n";
      report += "Other: " + (domains.other || 0) + "\n\n";
      
      if (pages.length > 0) {
        report += "FOUND ON THESE URLS\n";
        report += "------------------------------\n";
        pages.forEach((p, i) => {
          report += (i+1) + ". " + p.url + "\n";
          report += "   Domain: " + (p.domain || "Unknown") + "\n";
          report += "   Date: " + (p.date_indexed || "Unknown") + "\n\n";
        });
      }
      
      if (rs.warnings && rs.warnings.length > 0) {
        report += "WARNINGS\n";
        report += "------------------------------\n";
        rs.warnings.forEach(w => {
          report += "! " + w.type + ": " + w.message + "\n";
        });
      }
      
      const blob = new Blob([report], { type: "text/plain" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "reverse-search-report-" + Date.now() + ".txt";
      a.click();
      URL.revokeObjectURL(url);
    }
    // Load and display report
   document.addEventListener('DOMContentLoaded', function() {
    try {
     const data = sessionStorage.getItem('verificationData');
        
        if (!data) {
          document.getElementById('reportContent').classList.add('hidden');
          document.getElementById('noDataMessage').classList.remove('hidden');
          return;
        }

        const parsed = JSON.parse(data);
        const result = parsed._rawResponse || parsed;
        window.currentVerificationResult = result;

        // 1. File name & confidence
        document.getElementById('fileName').textContent = result.filename || 'Unknown File';
        const confidence = result.confidence?.percentage || 0;
        document.getElementById('overallConfidence').innerHTML = `${confidence}<span class="text-xl align-top">%</span>`;

        // Confidence level text
        document.getElementById('confidenceLevel').textContent = 
          `${result.confidence?.level || 'UNKNOWN'} CONFIDENCE`;

        // 2. Verdict badge
        const verdictBadge = document.getElementById('verdictBadge');
        const aiConf = result.ai_detection?.ai_confidence || 0;
        const isLikelyAI = result.ai_detection?.likely_ai_generated || false;
        
        // Handle videos differently from images
        if (result.kind === 'video' && result.video_analysis?.analysis?.verdict) {
          const videoVerdict = result.video_analysis.analysis.verdict;
          const aiPercentage = result.video_analysis.analysis.aiPercentage || 0;
          
          // Map video verdicts to appropriate badges
          if (videoVerdict === 'LIKELY_AI_GENERATED' || videoVerdict === 'AI_GENERATED') {
            verdictBadge.innerHTML = `
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"/>
              </svg>
              AI-GENERATED VIDEO
            `;
            verdictBadge.className = 'inline-flex items-center gap-2 px-4 py-2 pill border border-purple-500/40 bg-purple-500/10 text-purple-300 text-sm font-medium';
          } else if (videoVerdict === 'SUSPICIOUS' || videoVerdict === 'POSSIBLY_MANIPULATED') {
            verdictBadge.innerHTML = `
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
              </svg>
              ${aiPercentage >= 50 ? 'SIGNIFICANT MIX OF VIDEO AND AI CONTENT' : 'SUSPICIOUS VIDEO CONTENT'}
            `;
            verdictBadge.className = 'inline-flex items-center gap-2 px-4 py-2 pill border border-amber-500/40 bg-amber-500/10 text-amber-300 text-sm font-medium';
          } else if (videoVerdict === 'AUTHENTIC') {
            verdictBadge.innerHTML = `
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
              AUTHENTIC VIDEO
            `;
            verdictBadge.className = 'inline-flex items-center gap-2 px-4 py-2 pill border border-green-500/40 bg-green-500/10 text-green-400 text-sm font-medium';
          } else {
            // Fallback to raw verdict
            verdictBadge.innerHTML = `
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              ${videoVerdict}
            `;
            verdictBadge.className = 'inline-flex items-center gap-2 px-4 py-2 pill border border-slate-500/40 bg-slate-500/10 text-slate-300 text-sm font-medium';
          }
        } 
        // Handle images (original logic)
        else {
          if (isLikelyAI || aiConf >= 70) {
            verdictBadge.innerHTML = `
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
              </svg>
              AI-GENERATED IMAGE
            `;
           verdictBadge.className = 'inline-flex items-center gap-2 px-4 py-2 pill border border-purple-500/40 bg-purple-500/10 text-purple-300 text-sm font-medium'; 
         } else if (aiConf >= 40) {
            verdictBadge.innerHTML = `
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
              </svg>
              EDITED PHOTOGRAPH
            `;
            verdictBadge.className = 'inline-flex items-center gap-2 px-4 py-2 pill border border-amber-500/40 bg-amber-500/10 text-amber-300 text-sm font-medium';
          } else {
            verdictBadge.innerHTML = `
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4"/>
              </svg>
              LIKELY CAMERA-CAPTURED
            `;
            verdictBadge.className = 'inline-flex items-center gap-2 px-4 py-2 pill border border-green-500/40 bg-green-500/10 text-green-400 text-sm font-medium';
          }
        }

        // 3. Warnings
        if (result.confidence?.warnings?.length > 0) {
          document.getElementById('warningsSection').classList.remove('hidden');
          const warningsList = document.getElementById('warningsList');
          warningsList.innerHTML = result.confidence.warnings.map(w => 
            `<li class="flex items-start gap-2">
              <span class="text-amber-400 mt-0.5">‚ö†</span>
              <span>${w}</span>
            </li>`
          ).join('');
        }

        // 4. Quick stats
        document.getElementById('fileType').textContent = result.filename?.split('.').pop()?.toUpperCase() || '-';
        document.getElementById('fileSize').textContent = formatFileSize(result.size_bytes);
        document.getElementById('mediaKind').textContent = result.kind?.toUpperCase() || '-';
        document.getElementById('timesVerified').textContent = result.verification?.times_verified || 1;
        document.getElementById('firstSeen').textContent = formatDate(result.verification?.first_seen);

        // Cryptographic fingerprint
        document.getElementById('sha256Hash').textContent = result.fingerprint?.hash || '-';
        document.getElementById('pHash').textContent = result.phash || 'Not available';

        // 5. AI Generator Detection
        if (result.generator_detection) {
          document.getElementById('aiAnalysisSection').classList.remove('hidden');
          const gd = result.generator_detection;
          
          const likelyGen = gd.likelyGenerator || 'Unknown';
          const genConf = gd.confidence || 0;
          document.getElementById('likelyGenerator').textContent = 
            `${likelyGen.charAt(0).toUpperCase() + likelyGen.slice(1)} (${genConf}%)`;
          document.getElementById('generatorConfidence').textContent = `${genConf}%`;
          document.getElementById('generatorConfidenceBar').style.width = `${genConf}%`;

          // Verdict text
          if (genConf >= 60) {
            document.getElementById('generatorVerdict').textContent = 
              `Strong indicators of ${likelyGen} generation patterns detected.`;
          } else if (genConf >= 30) {
            document.getElementById('generatorVerdict').textContent = 
              `Moderate indicators suggest possible ${likelyGen} origin.`;
          } else {
            document.getElementById('generatorVerdict').textContent = 
              `Low AI generator indicators. Content appears to be authentic or heavily modified.`;
          }

          // Indicators
          if (gd.indicators?.length > 0) {
            document.getElementById('generatorIndicators').innerHTML = gd.indicators.map(ind => 
              `<li class="flex items-start gap-2">
                <span class="text-purple-400">‚Ä¢</span>
                <span>${ind}</span>
              </li>`
            ).join('');
          }

          // Probabilities
          if (gd.probabilities) {
            const sorted = Object.entries(gd.probabilities).sort((a, b) => b[1] - a[1]);
            const colors = {
              sora: 'bg-rose-400',
              runway: 'bg-blue-400',
              pika: 'bg-green-400',
              kling: 'bg-amber-400',
              midjourney: 'bg-purple-400',
              dalle: 'bg-indigo-400',
              stableDiffusion: 'bg-sky-400',
              firefly: 'bg-orange-400'
            };

            document.getElementById('generatorProbabilities').innerHTML = sorted.slice(0, 6).map(([gen, prob]) => `
              <div>
                <div class="flex justify-between text-xs mb-0.5">
                  <span class="capitalize">${gen.replace(/([A-Z])/g, ' $1').trim()}</span>
                  <span>${prob}%</span>
                </div>
                <div class="w-full h-1.5 rounded-full bg-slate-800 overflow-hidden">
                  <div class="h-full ${colors[gen] || 'bg-slate-400'} transition-all duration-1000" style="width:${prob}%"></div>
                </div>
              </div>
            `).join('');
          }
        }

        // AI Content Analysis
        if (result.ai_detection) {
          document.getElementById('aiAnalysisSection').classList.remove('hidden');
          const ai = result.ai_detection;
          
          const aiConfDisplay = ai.ai_confidence || 0;
          document.getElementById('aiConfidence').textContent = `${aiConfDisplay}%`;
          document.getElementById('aiConfidenceBar').style.width = `${aiConfDisplay}%`;
          document.getElementById('ensembleInfo').textContent = 
            `Ensemble of ${ai.detector_count || 1} detectors`;

          // AI verdict badge
          const aiVerdictBadge = document.getElementById('aiVerdictBadge');
          if (ai.likely_ai_generated) {
            aiVerdictBadge.textContent = 'AI-GENERATED';
            aiVerdictBadge.className = 'px-2.5 py-1 pill bg-red-500/15 text-red-300 text-[10px] font-semibold border border-red-500/30';
          } else {
            aiVerdictBadge.textContent = 'AUTHENTIC';
            aiVerdictBadge.className = 'px-2.5 py-1 pill bg-emerald-500/15 text-emerald-300 text-[10px] font-semibold border border-emerald-500/30';
          }

          // Individual detector scores
          if (ai.ensemble_results || ai.individual_results) {
            const ir = ai.ensemble_results || ai.individual_results;
            let scoresHtml = '';
            if (ir.jpeg) {
              scoresHtml += `
                <div class="bg-slate-950/60 rounded-xl p-2.5 text-center">
                  <p class="text-[10px] text-slate-400 mb-0.5">JPEG</p>
                  <p class="text-sm font-semibold">${ir.jpeg.confidence}%</p>
                </div>
              `;
            }
            if (ir.local) {
              scoresHtml += `
                <div class="bg-slate-950/60 rounded-xl p-2.5 text-center">
                  <p class="text-[10px] text-slate-400 mb-0.5">Local</p>
                  <p class="text-sm font-semibold">${ir.local.confidence}%</p>
                </div>
              `;
            }
            if (ir.huggingface) {
              scoresHtml += `
                <div class="bg-slate-950/60 rounded-xl p-2.5 text-center">
                  <p class="text-[10px] text-slate-400 mb-0.5">HF Model</p>
                  <p class="text-sm font-semibold">${ir.huggingface.confidence}%</p>
                </div>
              `;
            }
            document.getElementById('detectorScores').innerHTML = scoresHtml;
          }

          // AI indicators
          if (ai.indicators?.length > 0) {
            document.getElementById('aiIndicators').innerHTML = ai.indicators.slice(0, 5).map(ind => 
              `<li class="flex items-start gap-2">
                <span class="text-red-300 mt-0.5">‚ö†</span>
                <span>${ind}</span>
              </li>`
            ).join('');
          }
        }

        // 6. Video Analysis
        if (result.kind === 'video' && result.video_analysis) {
          document.getElementById('videoAnalysisSection').classList.remove('hidden');
          const va = result.video_analysis.analysis || {};
          const metadata = result.video_analysis.metadata || {};
          
          document.getElementById('framesAnalyzed').textContent = va.framesAnalyzed || 0;
          document.getElementById('aiFrames').textContent = va.aiGeneratedFrames || 0;
          document.getElementById('suspiciousFrames').textContent = `${va.suspiciousPercentage || 0}%`;
          document.getElementById('aiPercentage').textContent = `${va.aiPercentage || 0}%`;
          // Set verdict text and color dynamically
          const verdictEl = document.getElementById('videoVerdict');
          verdictEl.textContent = va.verdict || '-';
          
          // Update color based on verdict
          if (va.verdict === 'AUTHENTIC') {
            verdictEl.className = 'text-sm font-bold text-green-400';
          } else if (va.verdict === 'LIKELY_AI_GENERATED' || va.verdict === 'AI_GENERATED') {
            verdictEl.className = 'text-sm font-bold text-purple-300';
          } else if (va.verdict === 'SUSPICIOUS' || va.verdict === 'POSSIBLY_MANIPULATED') {
            verdictEl.className = 'text-sm font-bold text-amber-300';
          } else {
            verdictEl.className = 'text-sm font-bold text-slate-300';
          }

          if (va.temporalAnalysis) {
            const ta = va.temporalAnalysis;
            document.getElementById('temporalInconsistencies').textContent = 
              ta.inconsistencies_detected ? 'Yes' : 'None';
            document.getElementById('temporalInconsistencies').className = 
              ta.inconsistencies_detected ? 'text-red-300' : 'text-emerald-300';
            document.getElementById('temporalSeverity').textContent = ta.severity || 'Low';
            document.getElementById('morphingDetected').textContent = 
              ta.morphing_detected ? 'Yes' : 'No';
          }

          document.getElementById('videoDuration').textContent = metadata.duration ? 
            `${Math.round(metadata.duration)}s` : '-';
          document.getElementById('videoResolution').textContent = metadata.resolution || '-';
          document.getElementById('videoFps').textContent = metadata.fps ? `${metadata.fps} fps` : '-';
        }

        // 7. Audio Analysis
        if (result.kind === 'audio' && result.chromaprint) {
          document.getElementById('audioAnalysisSection').classList.remove('hidden');
          document.getElementById('audioDuration').textContent = result.audio_duration ? 
            `${Math.round(result.audio_duration)}s` : '-';
          document.getElementById('chromaprint').textContent = 
            result.chromaprint.substring(0, 40) + '...';
          document.getElementById('musicIdentified').textContent = 
            result.music_identification?.found ? 
              `${result.music_identification.title} - ${result.music_identification.artist}` : 
              'No match';
        }

        // 8. Deepfake Detection
        if (result.deepfake_detection) {
          document.getElementById('deepfakeSection').classList.remove('hidden');
          const df = result.deepfake_detection;
          document.getElementById('deepfakeDetected').textContent = df.is_deepfake ? 'Yes' : 'No';
          document.getElementById('deepfakeDetected').className = 
            df.is_deepfake ? 'font-semibold text-red-300' : 'font-semibold text-emerald-300';
          document.getElementById('deepfakeConfidence').textContent = `${df.confidence || 0}%`;
          document.getElementById('facesDetected').textContent = df.faces_detected || 0;
          document.getElementById('deepfakeMethod').textContent = df.method || 'Multi-factor';
        }

        // 9. Confidence Breakdown
        if (result.confidence?.factors) {
          const factorsHtml = result.confidence.factors.map(factor => `
            <div class="bg-slate-950/50 p-4 rounded-xl">
              <div class="flex justify-between items-center mb-2">
                <span class="font-semibold">${factor.name}</span>
                <span class="text-xs text-slate-400">${factor.score}/${factor.max}</span>
              </div>
              <div class="w-full h-2 rounded-full bg-slate-800 overflow-hidden mb-3">
                <div class="h-full bg-gradient-to-r from-indigo-400 to-purple-400 transition-all duration-1000" 
                     style="width: ${factor.percentage}%"></div>
              </div>
              <div class="space-y-1">
                ${factor.details.map(d => `<p class="text-[10px] text-slate-400">‚Ä¢ ${d}</p>`).join('')}
              </div>
            </div>
          `).join('');
          document.getElementById('confidenceFactors').innerHTML = factorsHtml;
        }

        // 10. Duplicate Detection
        if (result.verification?.times_verified > 1 || result.similar_images?.length > 0) {
          document.getElementById('duplicateSection').classList.remove('hidden');
          document.getElementById('exactMatches').textContent = 
            result.verification?.times_verified > 1 ? result.verification.times_verified - 1 : 0;
          document.getElementById('similarImagesCount').textContent = 
            result.similar_images?.length || 0;
          document.getElementById('totalVerifications').textContent = 
            result.verification?.times_verified || 1;

          if (result.verification?.previous_uploads?.length > 0) {
            document.getElementById('previousVerifications').classList.remove('hidden');
            document.getElementById('verificationHistory').innerHTML = 
              result.verification.previous_uploads.map(upload => `
                <div class="flex justify-between text-[10px]">
                  <span class="text-slate-400">${formatDate(upload.date)}</span>
                  <span class="font-mono">${upload.verification_id}</span>
                </div>
              `).join('');
          }
        }

        // 11. Forensic Analysis
        if (result.shadow_physics) {
          document.getElementById('shadowConsistency').textContent = 
            result.shadow_physics.consistent ? 'Consistent' : 'Inconsistent';
        }
        if (result.camera_verification) {
          const cv = result.camera_verification;
          document.getElementById('cameraMake').textContent = cv.details?.make || 'Unknown';
          document.getElementById('cameraModel').textContent = cv.details?.model || 'Unknown';
          document.getElementById('cameraVerified').textContent = cv.is_valid ? 'Yes' : 'No';
        }

        // 12. External Verification
        if (result.google_vision) {
          const webMatches = result.google_vision.results?.web_detection?.pages_with_matching_images?.length || 0;
          document.getElementById('googleVisionStatus').textContent = 
            webMatches > 0 ? `${webMatches} matches` : 'No matches';
        }
        if (result.c2pa_verification) {
          document.getElementById('c2paStatus').textContent = 
            result.c2pa_verification.has_c2pa_credentials ? 
              (result.c2pa_verification.credentials_valid ? 'Valid' : 'Invalid') : 
              'None found';
        }
        if (result.virustotal) {
          document.getElementById('virusTotalStatus').textContent = 
            result.virustotal.found ? 'Found in DB' : 'Clean';
        }
        if (result.weather_verification || result.landmark_verification) {
          const weatherOk = result.weather_verification?.verified;
          const landmarkOk = result.landmark_verification?.verified;
          if (weatherOk || landmarkOk) {
            document.getElementById('weatherLandmarkStatus').textContent = 'Verified';
          } else {
            document.getElementById('weatherLandmarkStatus').textContent = 'No data';
          }
        }
// NEW: JPEG Forensics
        if (result.ai_detection?.forensic_analysis) {
          document.getElementById('jpegForensicsSection').classList.remove('hidden');
          const fa = result.ai_detection.forensic_analysis;
          
          document.getElementById('manipulationConfidence').textContent = `${fa.manipulation_confidence || 0}%`;
          document.getElementById('compressionQuality').textContent = fa.compression_quality || '-';
          document.getElementById('noiseLevel').textContent = fa.noise_level || 'unknown';
          document.getElementById('elaStatus').textContent = fa.ela_performed ? 'Performed' : 'Not performed';
          document.getElementById('doubleCompressed').textContent = fa.double_compressed ? 'Yes' : 'No';
          document.getElementById('doubleCompressed').className = fa.double_compressed ? 'text-red-300' : 'text-emerald-300';
          document.getElementById('qualityEstimate').textContent = fa.compression_quality ? `${fa.compression_quality}%` : '-';
          
          if (result.ai_detection.indicators?.length > 0) {
            document.getElementById('forensicIndicators').innerHTML = result.ai_detection.indicators.slice(0, 5).map(ind => 
              `<li class="flex items-start gap-2">
                <span class="text-cyan-300">‚Ä¢</span>
                <span>${ind}</span>
              </li>`
            ).join('');
          }
        }

        // NEW: TinEye Reverse Search
        // Enhanced Reverse Image Search Display
        if (result.reverse_image_search) {
          const rs = result.reverse_image_search;
          const combined = rs.combined_analysis || {};
          const bing = rs.bing || {};
          const tineye = rs.tineye || {};
          const spread = combined.spread_analysis || {};
          const domains = spread.domain_types || bing.domain_breakdown || tineye.domain_breakdown || {};
          
          // Show section if we have data
          if (rs.search_performed || combined.total_matches_found > 0 || bing.total_results > 0 || tineye.total_results > 0) {
            document.getElementById('reverseSearchSection').classList.remove('hidden');
            
            // Match Summary Cards
            const totalMatches = combined.total_matches_found || bing.total_results || tineye.total_results || 0;
            document.getElementById('totalMatchCount').textContent = totalMatches;
            
            // First Seen Date
            // Check Wayback for earlier date
            const waybackDate = rs.wayback?.earliest_appearance?.timestamp;
            const combinedDate = combined.first_appearance?.date || combined.age_analysis?.first_seen;
            const firstSeen = (waybackDate && combinedDate) 
              ? (new Date(waybackDate) < new Date(combinedDate) ? waybackDate : combinedDate)
              : (waybackDate || combinedDate);
            if (firstSeen) {
              const date = new Date(firstSeen);
              document.getElementById('firstSeenDate').textContent = date.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
            }
            
            // Image Age
            const ageReadable = rs.wayback?.earliest_appearance?.age?.human_readable || combined.age_analysis?.age_readable || rs.summary?.age || '-';
            document.getElementById('imageAgeDisplay').textContent = ageReadable;
            
            // Content Type
            const contentType = combined.content_type || rs.summary?.content_type || 'Unknown';
            const contentTypeFormatted = contentType.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
            document.getElementById('contentTypeDisplay').textContent = contentTypeFormatted;
            
            // Originality Score
            const isOriginal = combined.is_original;
            const origScore = isOriginal ? '‚úì' : (totalMatches > 0 ? `${totalMatches}` : '?');
            document.getElementById('originalConfidence').textContent = origScore;
            document.getElementById('originalConfidence').className = `text-2xl font-bold ${isOriginal ? 'text-emerald-300' : (totalMatches > 50 ? 'text-red-300' : 'text-amber-300')}`;
            
            // Source Category Breakdown with Visual Bars
            const maxCount = Math.max(
              domains.stock_photo_sites || 0,
              domains.news_sites || 0,
              domains.social_media || 0,
              domains.ecommerce || 0,
              domains.blogs || 0,
              domains.other || 0,
              1
            );
            
            const setBar = (barId, countId, value) => {
              document.getElementById(countId).textContent = value || 0;
              document.getElementById(barId).style.width = `${((value || 0) / maxCount) * 100}%`;
            };
            
            setBar('stockPhotoBar', 'stockPhotoCount', domains.stock_photo_sites);
            setBar('newsBar', 'newsCount', domains.news_sites);
            setBar('socialBar', 'socialCount', domains.social_media);
            setBar('ecommerceBar', 'ecommerceCount', domains.ecommerce);
            setBar('blogsBar', 'blogsCount', domains.blogs);
            setBar('otherBar', 'otherCount', domains.other);
            
            // Warnings
            if (rs.warnings && rs.warnings.length > 0) {
              document.getElementById('reverseSearchWarnings').classList.remove('hidden');
              document.getElementById('reverseSearchWarningsList').innerHTML = rs.warnings.map(w => 
                `<p><strong>${w.type.replace(/_/g, ' ')}:</strong> ${w.message}</p>`
              ).join('');
            }
            
            // Timeline
            const tineyePages = (tineye.top_matches || []).flatMap(match => 
              (match.backlinks || []).map(bl => ({
                url: bl.backlink,
                domain: match.domain,
                title: match.domain,
                date_indexed: bl.crawl_date
              }))
            );
            const bingPages = bing.pages_with_image || [];
            const pages = [...tineyePages, ...bingPages];
            if (pages.length > 0) {
              const timelineHtml = pages.slice(0, 10).map(p => {
                const date = p.date_indexed ? new Date(p.date_indexed).toLocaleDateString() : '-';
                return `
                  <div class="flex items-center gap-2 text-[10px] py-1 border-b border-slate-800 last:border-0">
                    <span class="text-slate-500 w-20">${date}</span>
                    <span class="text-slate-300 truncate flex-1">${p.domain || new URL(p.url).hostname}</span>
                  </div>
                `;
              }).join('');
              document.getElementById('imageTimeline').innerHTML = timelineHtml || '<p class="text-slate-500 text-[10px]">No timeline data</p>';
            }
            
            // Found URLs List
            if (pages.length > 0) {
              document.getElementById('urlListCount').textContent = `(${pages.length} sites)`;
              const urlsHtml = pages.slice(0, 15).map(p => `
                <a href="${p.url}" target="_blank" class="block text-[10px] py-1.5 px-2 bg-slate-900/50 rounded hover:bg-slate-800 transition truncate text-indigo-300 hover:text-indigo-200">
                  ${p.domain || new URL(p.url).hostname} ${p.title ? '- ' + p.title.substring(0, 40) : ''}
                </a>
              `).join('');
              document.getElementById('foundUrlsList').innerHTML = urlsHtml;
            }
            
            // First Appearance Detail
            const firstAppearance = combined.first_appearance || bing.first_indexed;
            if (firstAppearance && firstAppearance.date) {
              document.getElementById('firstAppearanceDetail').classList.remove('hidden');
              document.getElementById('firstAppearanceDate').textContent = new Date(firstAppearance.date).toLocaleDateString();
              document.getElementById('firstAppearanceSource').textContent = firstAppearance.source_domain || firstAppearance.domain || '-';
              const urlEl = document.getElementById('firstAppearanceUrl');
              urlEl.href = firstAppearance.source_url || firstAppearance.url || '#';
              urlEl.textContent = firstAppearance.source_url || firstAppearance.url || '-';
            }
          }
        }
        if (result.blockchain_verification) {
          document.getElementById('blockchainSection').classList.remove('hidden');

          // Show top blockchain badge
          const blockchainBadge = document.getElementById('blockchainBadge');
          const blockchainChainName = document.getElementById('blockchainChainName');
          const hasOTS = result.blockchain_verification.success && result.blockchain_verification.status;
          const hasPolygon = result.polygon_verification && result.polygon_verification.success;
          
          if (hasOTS && hasPolygon) {
            // Both blockchains
            blockchainBadge.classList.remove('hidden');
            blockchainChainName.textContent = '‚Çø Bitcoin + Polygon Verified';
          } else if (hasPolygon) {
            // Polygon only (instant)
            blockchainBadge.classList.remove('hidden');
            blockchainChainName.innerHTML = '<svg class="w-3 h-3 inline" viewBox="0 0 38.4 33.5" fill="currentColor"><path d="M29,10.2c-0.7-0.4-1.6-0.4-2.4,0L21,13.5l-3.8,2.1l-5.5,3.3c-0.7,0.4-1.6,0.4-2.4,0L5,16.3c-0.7-0.4-1.2-1.2-1.2-2.1v-5c0-0.8,0.4-1.6,1.2-2.1l4.3-2.5c0.7-0.4,1.6-0.4,2.4,0L16,7.2c0.7,0.4,1.2,1.2,1.2,2.1v3.3l3.8-2.2V7c0-0.8-0.4-1.6-1.2-2.1l-8-4.7c-0.7-0.4-1.6-0.4-2.4,0L1.2,5C0.4,5.4,0,6.2,0,7v9.4c0,0.8,0.4,1.6,1.2,2.1l8.1,4.7c0.7,0.4,1.6,0.4,2.4,0l5.5-3.2l3.8-2.2l5.5-3.2c0.7-0.4,1.6-0.4,2.4,0l4.3,2.5c0.7,0.4,1.2,1.2,1.2,2.1v5c0,0.8-0.4,1.6-1.2,2.1L29,28.8c-0.7,0.4-1.6,0.4-2.4,0l-4.3-2.5c-0.7-0.4-1.2-1.2-1.2-2.1V21l-3.8,2.2v3.3c0,0.8,0.4,1.6,1.2,2.1l8.1,4.7c0.7,0.4,1.6,0.4,2.4,0l8.1-4.7c0.7-0.4,1.2-1.2,1.2-2.1V17c0-0.8-0.4-1.6-1.2-2.1L29,10.2z"/></svg> Polygon Verified';
          } else if (hasOTS) {
            // Bitcoin only (pending confirmation)
            blockchainBadge.classList.remove('hidden');
            blockchainChainName.textContent = '‚Çø Bitcoin Timestamp';
          }
          
          if (!hasOTS && !hasPolygon) {
            document.getElementById('noBlockchainCard').classList.remove('hidden');
          } else {
            document.getElementById('noBlockchainCard').classList.add('hidden');
          }
          
          // OpenTimestamps (Bitcoin)
          if (hasOTS) {
            document.getElementById('opentimestampsCard').classList.remove('hidden');
            const ots = result.blockchain_verification;
            
            // Status badge
            const otsStatusBadge = document.getElementById('otsStatus');
            if (ots.status === 'confirmed') {
              otsStatusBadge.textContent = '‚úì CONFIRMED';
              otsStatusBadge.className = 'px-2 py-1 pill text-[10px] font-semibold bg-emerald-500/10 border border-emerald-500/40 text-emerald-300';
              document.getElementById('otsStatusText').textContent = 'Confirmed on Bitcoin';
              document.getElementById('otsBlockRow').classList.remove('hidden');
              document.getElementById('otsTimestampRow').classList.remove('hidden');
              document.getElementById('otsBlock').textContent = ots.bitcoin_block || '-';
              document.getElementById('otsTimestamp').textContent = formatDate(ots.timestamp);
            } else if (ots.status === 'pending') {
              otsStatusBadge.textContent = '‚è≥ PENDING';
              otsStatusBadge.className = 'px-2 py-1 pill text-[10px] font-semibold bg-amber-500/10 border border-amber-500/40 text-amber-300';
              document.getElementById('otsStatusText').textContent = 'Bitcoin confirmation pending';
            } else {
              otsStatusBadge.textContent = 'SUBMITTED';
              otsStatusBadge.className = 'px-2 py-1 pill text-[10px] font-semibold bg-blue-500/10 border border-blue-500/40 text-blue-300';
              document.getElementById('otsStatusText').textContent = 'Submitted to calendar servers';
            }
            
            document.getElementById('otsSubmitted').textContent = formatDate(ots.submitted_at);
            document.getElementById('otsVerifyLink').href = `https://opentimestamps.org`;
          }
          
          // Polygon
          if (hasPolygon) {
            document.getElementById('polygonCard').classList.remove('hidden');
            const poly = result.polygon_verification;
            
            const txShort = poly.transaction_hash ? 
              poly.transaction_hash.substring(0, 10) + '...' + poly.transaction_hash.substring(poly.transaction_hash.length - 8) : 
              '-';
            
            document.getElementById('polygonTxLink').textContent = txShort;
            document.getElementById('polygonTxLink').href = poly.explorer_url || '#';
            document.getElementById('polygonBlock').textContent = poly.block_number || '-';
            document.getElementById('polygonTimestamp').textContent = formatDate(poly.timestamp);
            document.getElementById('polygonGasCost').textContent = 
              poly.gas_cost_usd ? `$${poly.gas_cost_usd} (${parseFloat(poly.gas_cost_matic).toFixed(4)} MATIC)` : '-';
            document.getElementById('polygonExplorer').href = poly.explorer_url || '#';
          }
        }
        // 13. Blockchain (future - hidden for now)
        // Will be enabled when blockchain anchoring is implemented

        // 14. Recommendations
        const recommendations = [];
        if (aiConf >= 70) {
          recommendations.push('High AI probability detected. Consider additional manual review.');
          recommendations.push('Check for signs of manipulation or editing.');
        }
        if (result.confidence?.percentage < 50) {
          recommendations.push('Low confidence score. Verify source and context before sharing.');
        }
        if (result.verification?.times_verified > 3) {
          recommendations.push('This file has been verified multiple times. Check for duplicates.');
        }
        if (!result.camera_verification?.details?.make) {
          recommendations.push('No camera metadata found. This could indicate screenshot or AI generation.');
        }
        if (recommendations.length === 0) {
          recommendations.push('No immediate concerns detected. Content appears authentic.');
        }

        if (recommendations.length > 0) {
          document.getElementById('recommendationsSection').classList.remove('hidden');
          document.getElementById('recommendationsList').innerHTML = recommendations.map(r => 
            `<li class="flex items-start gap-2">
              <span class="text-blue-400 mt-0.5">‚Üí</span>
              <span>${r}</span>
            </li>`
          ).join('');
        }

        // 15. Timestamp
        document.getElementById('reportTimestamp').textContent = 
          `Report generated on ${new Date().toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
          })} at ${new Date().toLocaleTimeString()}`;
          
      } catch (error) {
        console.error('Report error:', error);
        alert('Error loading report: ' + error.message);
      }
    });
  </script>